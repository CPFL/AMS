THREE.STLLoader=function(){};THREE.STLLoader.prototype={constructor:THREE.STLLoader};THREE.STLLoader.prototype.load=function(e,t){function i(r){if(r.target.status===200||r.target.status===0){var i=n.parse(r.target.response||r.target.responseText);n.dispatchEvent({type:"load",content:i});if(t)t(i)}else{n.dispatchEvent({type:"error",message:"Couldn't load URL ["+e+"]",response:r.target.responseText})}}var n=this;var r=new XMLHttpRequest;r.addEventListener("load",i,false);r.addEventListener("progress",function(e){n.dispatchEvent({type:"progress",loaded:e.loaded,total:e.total})},false);r.addEventListener("error",function(){n.dispatchEvent({type:"error",message:"Couldn't load URL ["+e+"]"})},false);r.overrideMimeType("text/plain; charset=x-user-defined");r.open("GET",e,true);r.responseType="arraybuffer";r.send(null)};THREE.STLLoader.prototype.parse=function(e){var t=function(){var e,t,r,i;i=new DataView(n);t=32/8*3+32/8*3*3+16/8;r=i.getUint32(80,true);e=80+32/8+r*t;return e===i.byteLength};var n=this.ensureBinary(e);return t()?this.parseBinary(n):this.parseASCII(this.ensureString(e))};THREE.STLLoader.prototype.parseBinary=function(e){var t,n,r,i,s,o,u,a,f,l,c;i=new DataView(e);r=i.getUint32(80,true);n=new THREE.Geometry;a=84;f=12*4+2;for(t=0;t<r;t++){l=a+t*f;o=new THREE.Vector3(i.getFloat32(l,true),i.getFloat32(l+4,true),i.getFloat32(l+8,true));for(u=1;u<=3;u++){c=l+u*12;n.vertices.push(new THREE.Vector3(i.getFloat32(c,true),i.getFloat32(c+4,true),i.getFloat32(c+8,true)))}s=n.vertices.length;n.faces.push(new THREE.Face3(s-3,s-2,s-1,o))}n.computeCentroids();n.computeBoundingSphere();return n};THREE.STLLoader.prototype.parseASCII=function(e){var t,n,r,i,s,o,u,a;t=new THREE.Geometry;i=/facet([\s\S]*?)endfacet/g;while((u=i.exec(e))!=null){a=u[0];s=/normal[\s]+([\-+]?[0-9]+\.?[0-9]*([eE][\-+]?[0-9]+)?)+[\s]+([\-+]?[0-9]*\.?[0-9]+([eE][\-+]?[0-9]+)?)+[\s]+([\-+]?[0-9]*\.?[0-9]+([eE][\-+]?[0-9]+)?)+/g;while((u=s.exec(a))!=null){r=new THREE.Vector3(parseFloat(u[1]),parseFloat(u[3]),parseFloat(u[5]))}o=/vertex[\s]+([\-+]?[0-9]+\.?[0-9]*([eE][\-+]?[0-9]+)?)+[\s]+([\-+]?[0-9]*\.?[0-9]+([eE][\-+]?[0-9]+)?)+[\s]+([\-+]?[0-9]*\.?[0-9]+([eE][\-+]?[0-9]+)?)+/g;while((u=o.exec(a))!=null){t.vertices.push(new THREE.Vector3(parseFloat(u[1]),parseFloat(u[3]),parseFloat(u[5])))}n=t.vertices.length;t.faces.push(new THREE.Face3(n-3,n-2,n-1,r))}t.computeCentroids();t.computeBoundingBox();t.computeBoundingSphere();return t};THREE.STLLoader.prototype.ensureString=function(e){if(typeof e!=="string"){var t=new Uint8Array(e);var n="";for(var r=0;r<e.byteLength;r++){n+=String.fromCharCode(t[r])}return n}else{return e}};THREE.STLLoader.prototype.ensureBinary=function(e){if(typeof e==="string"){var t=new Uint8Array(e.length);for(var n=0;n<e.length;n++){t[n]=e.charCodeAt(n)&255}return t.buffer||t}else{return e}};THREE.EventDispatcher.prototype.apply(THREE.STLLoader.prototype);if(typeof DataView==="undefined"){DataView=function(e,t,n){this.buffer=e;this.byteOffset=t||0;this.byteLength=n||e.byteLength||e.length;this._isString=typeof e==="string"};DataView.prototype={_getCharCodes:function(e,t,n){t=t||0;n=n||e.length;var r=t+n;var i=[];for(var s=t;s<r;s++){i.push(e.charCodeAt(s)&255)}return i},_getBytes:function(e,t,n){var r;if(n===undefined){n=this._littleEndian}if(t===undefined){t=this.byteOffset}else{t=this.byteOffset+t}if(e===undefined){e=this.byteLength-t}if(typeof t!=="number"){throw new TypeError("DataView byteOffset is not a number")}if(e<0||t+e>this.byteLength){throw new Error("DataView length or (byteOffset+length) value is out of bounds")}if(this.isString){r=this._getCharCodes(this.buffer,t,t+e)}else{r=this.buffer.slice(t,t+e)}if(!n&&e>1){if(!(r instanceof Array)){r=Array.prototype.slice.call(r)}r.reverse()}return r},getFloat64:function(e,t){var n=this._getBytes(8,e,t),r=1-2*(n[7]>>7),i=((n[7]<<1&255)<<3|n[6]>>4)-((1<<10)-1),s=(n[6]&15)*Math.pow(2,48)+n[5]*Math.pow(2,40)+n[4]*Math.pow(2,32)+n[3]*Math.pow(2,24)+n[2]*Math.pow(2,16)+n[1]*Math.pow(2,8)+n[0];if(i===1024){if(s!==0){return NaN}else{return r*Infinity}}if(i===-1023){return r*s*Math.pow(2,-1022-52)}return r*(1+s*Math.pow(2,-52))*Math.pow(2,i)},getFloat32:function(e,t){var n=this._getBytes(4,e,t),r=1-2*(n[3]>>7),i=(n[3]<<1&255|n[2]>>7)-127,s=(n[2]&127)<<16|n[1]<<8|n[0];if(i===128){if(s!==0){return NaN}else{return r*Infinity}}if(i===-127){return r*s*Math.pow(2,-126-23)}return r*(1+s*Math.pow(2,-23))*Math.pow(2,i)},getInt32:function(e,t){var n=this._getBytes(4,e,t);return n[3]<<24|n[2]<<16|n[1]<<8|n[0]},getUint32:function(e,t){return this.getInt32(e,t)>>>0},getInt16:function(e,t){return this.getUint16(e,t)<<16>>16},getUint16:function(e,t){var n=this._getBytes(2,e,t);return n[1]<<8|n[0]},getInt8:function(e){return this.getUint8(e)<<24>>24},getUint8:function(e){return this._getBytes(1,e)[0]}}}
